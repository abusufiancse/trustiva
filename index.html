<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Optional: warm the cache for a poster + a video -->
  <link rel="preload" as="image" href="assets/images/E9/E9_1.jpg">
  <link rel="preload" as="video" href="assets/images/E9/video/E9_video.mp4" type="video/mp4" crossorigin>

  <meta charset="UTF-8" />
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trustiva - Premium Gaming Accessories</title>

  <!-- (Optional but recommended) Meta domain verification -->
  <!-- Replace the content value with the code from Business Settings → Brand Safety → Domains -->
  <meta name="facebook-domain-verification" content="eeglikh15r6jd1jr6nabknt49i0x5u" />

  <!-- Fonts & libs -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap"
    rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- ===================== META PIXEL (PRO) ===================== -->
  <script>
    !(function (f, b, e, v, n, t, s) {
      if (f.fbq) return; n = f.fbq = function () { n.callMethod ? n.callMethod.apply(n, arguments) : n.queue.push(arguments) };
      if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
      n.queue = []; t = b.createElement(e); t.async = !0; t.src = v;
      s = b.getElementsByTagName(e)[0]; s.parentNode.insertBefore(t, s)
    })(window, document, 'script', 'https://connect.facebook.net/en_US/fbevents.js');

    // Your Pixel ID
    // Pixel ID
    const FB_PIXEL_ID = '818335943873870';

    // Init (add phone later at checkout if you want AM)
    fbq('init', FB_PIXEL_ID, { ph: '' });

    // One real PageView on the first page load
    fbq('track', 'PageView');

    // Helpers + SPA PageView with dedupe
    (function () {
      // private dedupe state
      let lastPv = { label: null, t: 0 };

      // expose helpers
      window._fx = {
        uuid() {
          return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {
            const r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
          });
        },
        track(name, params = {}) {
          const eventID = this.uuid();
          fbq('track', name, { currency: 'BDT', ...params }, { eventID });
          return eventID;
        },
        trackCustom(name, params = {}) {
          const eventID = this.uuid();
          fbq('trackCustom', name, { currency: 'BDT', ...params }, { eventID });
          return eventID;
        },
        pv(label) {
          const now = Date.now();
          if (lastPv.label === label && now - lastPv.t < 3000) return; // dedupe 3s
          lastPv = { label, t: now };
          fbq('track', 'PageView');                      // SPA PV
          this.trackCustom('VirtualPage', { page: label });
        }
      };
    })();

    // Store UTM & fbclid for better attribution + create first-party _fbp cookie
    (function () {
      try {
        const qp = new URLSearchParams(location.search);
        ['utm_source', 'utm_medium', 'utm_campaign', 'utm_content', 'utm_term', 'fbclid'].forEach(k => {
          const v = qp.get(k); if (v) localStorage.setItem(k, v);
        });
        if (!document.cookie.split('; ').some(x => x.startsWith('_fbp='))) {
          const val = `fb.1.${Date.now()}.${Math.random().toString(36).slice(2)}`;
          document.cookie = `_fbp=${val}; path=/; max-age=63072000; SameSite=Lax`;
        }
      } catch (e) { }
    })();

    // Conversions API: send to your Worker in parallel with Pixel (browser)
    // TODO: Replace YOUR_WORKER_URL with your Cloudflare Worker endpoint
    function sendCAPI(name, params = {}, reuseEventID = null) {
      try {
        // Safe cookie parse
        const cookieStr = document.cookie || "";
        const cookies = Object.fromEntries(
          cookieStr
            .split(/; */)
            .filter(Boolean)
            .map(kv => {
              const i = kv.indexOf("=");
              return i === -1 ? [kv, ""] : [kv.slice(0, i), kv.slice(i + 1)];
            })
        );
        const fbp = cookies["_fbp"];
        const url = location.href;

        // Phone from form (string), trimmed
        const phoneEl = document.getElementById("customer-phone");
        const phone = (phoneEl?.value || "").trim();

        // Reuse event_id for de-dup if provided
        const event_id = reuseEventID || _fx.uuid();

        // Persist fbclid so we can build fbc later visits
        const sp = new URLSearchParams(location.search);
        const fbclid = localStorage.getItem("fbclid") || sp.get("fbclid");
        if (fbclid) localStorage.setItem("fbclid", fbclid);

        // City/State (District) from form
        const ct = document.getElementById("thana-city")?.value?.trim();
        const st = document.getElementById("district")?.value?.trim();

        fetch("https://trustiva.trustiva-shop.workers.dev", {
          method: "POST",
          headers: { "content-type": "application/json" },
          body: JSON.stringify({
            event_name: name,
            event_id,
            event_source_url: url,
            user_data: {
              ph: phone,                                // ✅ use the string
              fbp,
              client_user_agent: navigator.userAgent,
              ct,
              st,
              fbc: fbclid ? `fb.1.${Date.now()}.${fbclid}` : undefined
            },
            custom_data: { currency: "BDT", ...params }
          })
        }).catch(() => { });
        return event_id;
      } catch {
        return null;
      }
    }

  </script>
  <noscript>
    <img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=818335943873870&ev=PageView&noscript=1" />
  </noscript>
  <!-- =================== /META PIXEL (PRO) =================== -->

  <style>
    :root {
      --color-primary: #15803d;
      --color-primary-foreground: #fff;
      --color-secondary: #84cc16;
      --color-accent: #22c55e;
      --color-background: #fff;
      --color-foreground: #1f2937;
      --color-muted: #f3f4f6;
      --color-muted-foreground: #6b7280;
      --color-border: #e5e7eb;
    }

    .dark {
      --color-primary: #22c55e;
      --color-primary-foreground: #fff;
      --color-secondary: #84cc16;
      --color-accent: #15803d;
      --color-background: #111827;
      --color-foreground: #f9fafb;
      --color-muted: #374151;
      --color-muted-foreground: #9ca3af;
      --color-border: #4b5563;
    }

    body {
      font-family: 'DM Sans', sans-serif;
      background: var(--color-background);
      color: var(--color-foreground);
      min-height: 100vh;
      transition: all .3s ease
    }

    .light {
      background: linear-gradient(135deg, #fff 0%, #f8fafc 50%, #f1f5f9 100%)
    }

    .dark {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%)
    }

    .page {
      animation: fadeIn .6s ease-in-out
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px)
      }

      to {
        opacity: 1;
        transform: translateY(0)
      }
    }

    .slider-image {
      transition: opacity 1s ease-in-out
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1
      }

      50% {
        opacity: .7
      }
    }

    .glass-effect {
      background: rgba(255, 255, 255, .9);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(0, 0, 0, .1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, .1)
    }

    .dark .glass-effect {
      background: rgba(15, 23, 42, .8);
      border: 1px solid rgba(255, 255, 255, .1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, .3)
    }

    .card-glass {
      backdrop-filter: blur(15px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, .10);
      border: 1px solid rgba(0, 0, 0, .08);
      background: rgba(255, 255, 255, .92)
    }

    .dark .card-glass {
      background: rgba(15, 23, 42, .80);
      border: 1px solid rgba(255, 255, 255, .1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, .30)
    }

    .gradient-text {
      background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text
    }

    .glow-effect {
      box-shadow: 0 0 20px rgba(34, 197, 94, .3)
    }

    .product-card {
      transition: all .4s cubic-bezier(.4, 0, .2, 1);
      overflow: hidden;
      background: var(--color-background);
      border: 1px solid var(--color-border);
      border-radius: 16px
    }

    .product-card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0, 0, 0, .15);
      border-color: var(--color-primary)
    }

    .dark .product-card:hover {
      box-shadow: 0 20px 40px rgba(34, 197, 94, .2)
    }

    .product-image {
      position: relative;
      overflow: hidden;
      border-radius: 16px 16px 0 0;
      background: #fff
    }

    .dark .product-image {
      background: #0b0f1a
    }

    .product-image {
      height: 14rem
    }

    @media (min-width:640px) {
      .product-image {
        height: 16rem
      }
    }

    @media (min-width:1024px) {
      .product-image {
        height: 18rem
      }
    }

    .product-image img {
      transition: transform .6s ease;
      width: 100%;
      height: 100%;
      object-fit: contain;
      object-position: center
    }

    .product-card:hover .product-image img {
      transform: scale(1.08)
    }

    .product-image .media-slot {
      width: 100%;
      height: 100%;
      position: relative;
    }

    .product-video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      object-position: center;
      background: #000;
      display: block;
    }

    .nav-top-bar {
      background: rgba(255, 255, 255, .95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(0, 0, 0, .1)
    }

    .dark .nav-top-bar {
      background: rgba(15, 23, 42, .95);
      border-bottom: 1px solid rgba(255, 255, 255, .1)
    }

    .nav-mobile {
      background: rgba(255, 255, 255, .95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(0, 0, 0, .08)
    }

    .dark .nav-mobile {
      background: rgba(15, 23, 42, .95);
      border-bottom: 1px solid rgba(255, 255, 255, .1)
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
      color: var(--color-primary-foreground);
      border: none;
      padding: 12px 24px;
      border-radius: 12px;
      font-weight: 600;
      transition: all .3s ease;
      box-shadow: 0 4px 15px rgba(21, 128, 61, .3)
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(21, 128, 61, .4)
    }

    .btn-solid {
      background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
      color: var(--color-primary-foreground);
      border: none;
      border-radius: 12px;
      padding: 12px 24px;
      font-weight: 700;
      transition: transform .2s ease, box-shadow .2s ease;
      box-shadow: 0 4px 15px rgba(21, 128, 61, .3)
    }

    .btn-solid:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(21, 128, 61, .4)
    }

    .btn-disabled {
      opacity: .6;
      cursor: not-allowed
    }

    .field {
      background: var(--color-background);
      color: var(--color-foreground);
      border: 2px solid var(--color-border);
      border-radius: 12px;
      padding: 12px 16px;
      transition: all .2s ease
    }

    .field::placeholder {
      color: var(--color-muted-foreground)
    }

    .field:focus {
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(16, 185, 129, .15);
      outline: none
    }

    .heading {
      color: var(--color-foreground)
    }

    .subtle {
      color: var(--color-muted-foreground)
    }

    .surface {
      background: var(--color-background);
      color: var(--color-foreground);
      border: 1px solid var(--color-border);
      border-radius: 9999px
    }

    .badge {
      background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
      color: var(--color-primary-foreground);
      border-radius: 9999px
    }

    .badge-red {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      color: #fff;
      border-radius: 9999px
    }

    .theme-toggle {
      position: relative;
      width: 56px;
      height: 28px;
      background: var(--color-muted);
      border-radius: 14px;
      cursor: pointer;
      transition: all .3s ease;
      border: 2px solid var(--color-border)
    }

    .theme-toggle::before {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 20px;
      height: 20px;
      background: var(--color-primary);
      border-radius: 50%;
      transition: all .3s ease;
      box-shadow: 0 2px 4px rgba(0, 0, 0, .2)
    }

    .dark .theme-toggle::before {
      transform: translateX(26px)
    }

    .hover-lift {
      transition: transform .3s ease, box-shadow .3s ease
    }

    .hover-lift:hover {
      transform: translateY(-8px);
      box-shadow: 0 25px 50px rgba(0, 0, 0, .15)
    }

    .pulse-animation {
      animation: pulse 2s infinite
    }

    .details-main-img {
      width: 100%;
      height: 22rem;
      object-fit: contain;
      object-position: center;
      background: #fff;
      border-radius: 1rem
    }

    @media (min-width:640px) {
      .details-main-img {
        height: 26rem
      }
    }

    @media (min-width:1024px) {
      .details-main-img {
        height: 28rem
      }
    }

    .thumb {
      width: 5rem;
      height: 4rem
    }

    @media (min-width:640px) {
      .thumb {
        width: 6rem;
        height: 4.5rem
      }
    }

    .hero-h {
      height: 13rem
    }

    @media (min-width:640px) {
      .hero-h {
        height: 18rem
      }
    }

    @media (min-width:1024px) {
      .hero-h {
        height: 24rem
      }
    }

    .tap-to-play {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, .3);
      color: #fff;
      border: 0
    }
  </style>
</head>

<body class="light">

  <!-- MOBILE COMPACT TOP BAR -->
  <div class="nav-mobile md:hidden sticky top-0 z-50">
    <div class="mx-auto px-3 py-2 flex items-center justify-between">
      <a href="#" id="home-logo-mobile" class="flex items-center space-x-2">
        <div class="w-9 h-9 rounded-full overflow-hidden flex items-center justify-center glow-effect">
          <img class="brand-logo w-full h-full object-contain" src="assets/images/logo/trustiva_logo.png"
            data-light="assets/images/logo/trustiva_logo.png" data-dark="assets/images/logo/trustiva_logo_dark.png"
            alt="Trustiva logo" decoding="async" fetchpriority="high" />
        </div>
        <span class="font-extrabold text-lg gradient-text">Trustiva</span>
      </a>
      <div class="flex items-center gap-3">
        <a href="tel:01758649737"
          class="px-2 py-1 rounded-full border border-[var(--color-border)] text-sm hover:bg-[var(--color-muted)]">
          <i class="fas fa-phone mr-1"></i> Call
        </a>
        <a href="mailto:itsofficetimebro@gmail.com" class="p-2 rounded-full border border-[var(--color-border)]"
          title="Email"><i class="fas fa-envelope"></i></a>
        <a href="https://www.facebook.com/trustivagaming" target="_blank"
          class="p-2 rounded-full border border-[var(--color-border)]" title="Facebook"><i
            class="fab fa-facebook"></i></a>
        <div class="theme-toggle" id="theme-toggle-mobile" title="Toggle Dark/Light"></div>
      </div>
    </div>
  </div>

  <!-- DESKTOP/TABLET NAV -->
  <nav class="glass-effect sticky top-0 z-40 py-2 hidden md:block">
    <div class="container mx-auto px-4">
      <div class="nav-top-bar flex justify-between items-center text-sm py-2 px-4 rounded-lg mb-2">
        <div class="flex items-center space-x-6 subtle">
          <a href="tel:01758649737" class="flex items-center hover:text-[var(--color-primary)]">
            <i class="fas fa-phone mr-2"></i><span>01758649737</span>
          </a>
          <a href="mailto:itsofficetimebro@gmail.com" class="flex items-center hover:text-[var(--color-primary)]">
            <i class="fas fa-envelope mr-2"></i><span>itsofficetimebro@gmail.com</span>
          </a>
          <span class="hidden lg:flex items-center"><i class="fas fa-map-marker-alt mr-2"></i> Puran Paltan, Dhaka
            1000</span>
        </div>
        <div class="flex items-center space-x-4">
          <a href="https://s.daraz.com.bd/s.Zp735" target="_blank" class="text-orange-500 hover:text-orange-400"><i
              class="fab fa-shopify text-lg"></i></a>
          <a href="https://www.facebook.com/share/1BAGKAbbq3/?mibextid=wwXIfr" target="_blank"
            class="text-blue-500 hover:text-blue-400"><i class="fab fa-facebook text-lg"></i></a>
          <a href="https://www.youtube.com/@trustivagaming" target="_blank" class="text-red-500 hover:text-red-400"><i
              class="fab fa-youtube text-lg"></i></a>
          <a href="https://www.instagram.com/trustiva.shop?igsh=eWp3OHJ2ZDE4MzQx&utm_source=qr" target="_blank"
            class="text-pink-500 hover:text-pink-400"><i class="fab fa-instagram text-lg"></i></a>
        </div>
      </div>

      <div class="flex justify-between items-center py-3">
        <a href="#" id="home-logo" class="flex items-center space-x-3">
          <div class="w-12 h-12 rounded-full overflow-hidden flex items-center justify-center glow-effect">
            <img class="brand-logo w-full h-full object-contain" src="assets/images/logo/trustiva_logo.png"
              data-light="assets/images/logo/trustiva_logo.png" data-dark="assets/images/logo/trustiva_logo_dark.png"
              alt="Trustiva logo" decoding="async" />
          </div>
          <h1 class="text-2xl font-bold gradient-text">Trustiva</h1>
        </a>

        <div class="flex items-center space-x-6">
          <div class="hidden md:flex items-center space-x-6">
            <a href="#social-section" class="hover:text-[var(--color-primary)] font-medium"><i
                class="fas fa-store mr-2"></i> Shop</a>
            <a href="#youtube-section" class="hover:text-[var(--color-primary)] font-medium"><i
                class="fab fa-youtube mr-2"></i> Videos</a>
            <a href="#facebook-section" class="hover:text-[var(--color-primary)] font-medium"><i
                class="fab fa-facebook mr-2"></i> Updates</a>
          </div>
          <div class="theme-toggle" id="theme-toggle" title="Toggle Dark/Light Mode"></div>
        </div>
      </div>
    </div>
  </nav>

  <!-- APP -->
  <div id="app" class="container mx-auto px-3 sm:px-4 py-6 sm:py-8 max-w-7xl">

    <!-- PRODUCT LIST -->
    <div id="product-list-page" class="page">
      <div class="text-center mb-8 sm:mb-12">
        <h2 class="text-3xl sm:text-5xl font-extrabold gradient-text mb-3 sm:mb-4">Premium Gaming Accessories</h2>
        <p class="text-base sm:text-xl subtle max-w-2xl mx-auto">Elevate your gaming experience with our
          professional-grade controllers and accessories</p>
      </div>

      <!-- HERO SLIDER -->
      <div class="relative w-full hero-h overflow-hidden rounded-2xl sm:rounded-3xl mb-8 sm:mb-16 shadow-2xl">
        <div id="hero-slider-container" class="w-full h-full"></div>
      </div>

      <!-- PRODUCTS -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-8 mb-12 sm:mb-16"></div>

      <!-- SOCIAL -->
      <div id="social-section" class="glass-effect rounded-2xl sm:rounded-3xl p-5 sm:p-8 mb-12 sm:mb-16">
        <div class="text-center mb-6 sm:mb-8">
          <h3 class="text-2xl sm:text-3xl font-bold gradient-text mb-3 sm:mb-4">Connect With Us</h3>
          <p class="subtle text-base sm:text-lg">Stay updated with our latest products and gaming content</p>
        </div>

        <div class="grid md:grid-cols-3 gap-5 sm:gap-8">
          <div
            class="glass-effect rounded-2xl p-5 text-center hover-lift border border-orange-200 dark:border-orange-800">
            <div
              class="w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-r from-orange-500 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-4 glow-effect">
              <i class="fab fa-shopify text-white text-2xl sm:text-3xl"></i>
            </div>
            <h4 class="text-lg sm:text-xl font-bold heading mb-2">Daraz Store</h4>
            <p class="subtle mb-4">Shop with fast delivery and secure payment options</p>
            <a href="https://s.daraz.com.bd/s.Zp735" target="_blank" class="btn-primary inline-flex items-center">
              <i class="fab fa-shopify mr-2"></i> Visit Store
            </a>
          </div>

          <div class="glass-effect rounded-2xl p-5 text-center hover-lift border border-blue-200 dark:border-blue-800">
            <div
              class="w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 glow-effect">
              <i class="fab fa-facebook text-white text-2xl sm:text-3xl"></i>
            </div>
            <h4 class="text-lg sm:text-xl font-bold heading mb-2">Facebook Page</h4>
            <p class="subtle mb-4">Get product updates and exclusive offers</p>
            <a href="https://www.facebook.com/share/1BAGKAbbq3/?mibextid=wwXIfr" target="_blank"
              class="btn-primary inline-flex items-center">
              <i class="fab fa-facebook mr-2"></i> Follow Us
            </a>
          </div>

          <div class="glass-effect rounded-2xl p-5 text-center hover-lift border border-pink-200 dark:border-pink-800">
            <div
              class="w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-r from-pink-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4 glow-effect">
              <i class="fab fa-instagram text-white text-2xl sm:text-3xl"></i>
            </div>
            <h4 class="text-lg sm:text-xl font-bold heading mb-2">Instagram</h4>
            <p class="subtle mb-4">Watch new gadget videos and gaming content</p>
            <a href="https://www.instagram.com/trustiva.shop?igsh=eWp3OHJ2ZDE4MzQx&utm_source=qr" target="_blank"
              class="btn-primary inline-flex items-center">
              <i class="fab fa-instagram mr-2"></i> Follow Us
            </a>
          </div>
        </div>
      </div>

      <!-- YOUTUBE -->
      <div id="youtube-section" class="glass-effect rounded-2xl sm:rounded-3xl p-5 sm:p-8 mb-12 sm:mb-16">
        <div class="text-center mb-6 sm:mb-8">
          <h3 class="text-2xl sm:text-3xl font-bold gradient-text mb-3 sm:mb-4"><i
              class="fab fa-youtube text-red-500 mr-3"></i>Gaming Tutorials & Reviews</h3>
          <p class="subtle text-base sm:text-lg">Learn how to use our products and see detailed reviews</p>
        </div>

        <div class="grid md:grid-cols-2 gap-6 sm:gap-8 items-center">
          <div class="aspect-video rounded-2xl overflow-hidden shadow-2xl">
            <iframe width="100%" height="100%" src="https://youtu.be/dqrl1QOLqBA?si=iUtN1YaJJw46b0NN"
              title="Trustiva Gaming Setup Tutorial" frameborder="0" loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen class="rounded-2xl" referrerpolicy="strict-origin-when-cross-origin"></iframe>
          </div>
          <div class="space-y-5 sm:space-y-6">
            <h4 class="text-xl sm:text-2xl font-bold heading">Subscribe for Latest Content</h4>
            <p class="subtle text-base sm:text-lg">Get notified about new product tutorials, gaming tips, and exclusive
              reviews.</p>
            <div class="flex flex-col sm:flex-row gap-3 sm:gap-4">
              <a href="https://www.youtube.com/@trustivagaming?sub_confirmation=1" target="_blank"
                class="btn-primary inline-flex items-center justify-center">
                <i class="fab fa-youtube mr-2"></i> Subscribe Now
              </a>
              <a href="https://www.youtube.com/@trustivagaming" target="_blank"
                class="border-2 border-[var(--color-primary)] text-[var(--color-primary)] hover:bg-[var(--color-primary)] hover:text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 inline-flex items-center justify-center">
                <i class="fab fa-youtube mr-2"></i> View Channel
              </a>
            </div>
            <div class="flex items-center space-x-4 text-sm subtle">
              <span class="flex items-center"><i class="fas fa-users mr-2"></i> 1.2K Subscribers</span>
              <span class="flex items-center"><i class="fas fa-video mr-2"></i> 25+ Videos</span>
            </div>
          </div>
        </div>
      </div>

      <!-- FACEBOOK -->
      <div id="facebook-section" class="glass-effect rounded-2xl sm:rounded-3xl p-5 sm:p-8 mb-12 sm:mb-16">
        <div class="text-center mb-6 sm:mb-8">
          <h3 class="text-2xl sm:text-3xl font-bold gradient-text mb-3 sm:mb-4"><i
              class="fab fa-facebook text-blue-500 mr-3"></i>Join Our Gaming Community</h3>
          <p class="subtle text-base sm:text-lg">Stay connected with fellow gamers and get exclusive updates</p>
        </div>

        <div class="grid md:grid-cols-2 gap-6 sm:gap-8 items-center">
          <div class="space-y-5 sm:space-y-6">
            <h4 class="text-xl sm:text-2xl font-bold heading">Get Exclusive Updates</h4>
            <p class="subtle text-base sm:text-lg">Be the first to know about new product launches, special offers, and
              gaming events.</p>
            <div class="space-y-3 sm:space-y-4">
              <div class="flex items-center space-x-3"><i
                  class="fas fa-check-circle text-[var(--color-primary)]"></i><span class="heading">New product
                  announcements</span></div>
              <div class="flex items-center space-x-3"><i
                  class="fas fa-check-circle text-[var(--color-primary)]"></i><span class="heading">Exclusive discount
                  codes</span></div>
              <div class="flex items-center space-x-3"><i
                  class="fas fa-check-circle text-[var(--color-primary)]"></i><span class="heading">Gaming tips and
                  tricks</span></div>
            </div>
            <div class="flex flex-col sm:flex-row gap-3 sm:gap-4">
              <a href="https://www.facebook.com/share/1BAGKAbbq3/?mibextid=wwXIfr" target="_blank"
                class="btn-primary inline-flex items-center justify-center"><i class="fab fa-facebook mr-2"></i> Follow
                Page</a>
              <a href="https://www.instagram.com/trustiva.shop?igsh=eWp3OHJ2ZDE4MzQx&utm_source=qr" target="_blank"
                class="border-2 border-[var(--color-primary)] text-[var(--color-primary)] hover:bg-[var(--color-primary)] hover:text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 inline-flex items-center justify-center"><i
                  class="fas fa-newspaper mr-2"></i> View Posts</a>
            </div>
          </div>

          <div class="glass-effect rounded-2xl p-6 text-center">
            <div
              class="w-20 h-20 sm:w-24 sm:h-24 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 glow-effect">
              <i class="fab fa-facebook text-white text-3xl sm:text-4xl"></i>
            </div>
            <h5 class="text-lg sm:text-xl font-bold heading mb-2">Trustiva Gaming</h5>
            <p class="subtle mb-4">Official Facebook Page</p>
            <div class="flex justify-center space-x-6 text-sm subtle">
              <span class="flex items-center"><i class="fas fa-thumbs-up mr-2"></i> 850+ Likes</span>
              <span class="flex items-center"><i class="fas fa-users mr-2"></i> 920+ Followers</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- PRODUCT DETAILS -->
    <div id="product-details-page" class="page" style="display:none;">
      <button id="back-to-products"
        class="mb-4 sm:mb-6 surface px-4 py-2 hover:shadow transition flex items-center space-x-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        <span>Back to Products</span>
      </button>

      <div
        class="card-glass rounded-2xl sm:rounded-3xl shadow-2xl p-5 sm:p-8 flex flex-col lg:flex-row items-start gap-6 sm:gap-8">
        <!-- Image slider -->
        <div class="lg:w-1/2 w-full">
          <div class="relative w-full overflow-hidden rounded-xl sm:rounded-2xl shadow-lg mb-3 sm:mb-4"
            style="background:#fff">
            <img id="main-product-image" src="/placeholder.svg" alt="Main Product Image" class="details-main-img"
              decoding="async" />
            <div class="absolute inset-y-0 left-0 flex items-center">
              <button id="slider-prev"
                class="bg-black/50 text-white p-2 sm:p-3 rounded-r-lg hover:bg-black/70 transition">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 sm:h-6 sm:w-6" fill="none" viewBox="0 0 24 24"
                  stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
              </button>
            </div>
            <div class="absolute inset-y-0 right-0 flex items-center">
              <button id="slider-next"
                class="bg-black/50 text-white p-2 sm:p-3 rounded-l-lg hover:bg-black/70 transition">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 sm:h-6 sm:w-6" fill="none" viewBox="0 0 24 24"
                  stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </button>
            </div>
          </div>
          <div id="thumbnails-container" class="flex flex-wrap justify-center gap-2 sm:gap-3 mt-2 sm:mt-3"></div>
        </div>

        <!-- Details -->
        <div class="lg:w-1/2 w-full">
          <h2 id="details-title" class="text-2xl sm:text-4xl font-bold heading mb-2 sm:mb-3"></h2>

          <!-- Price block -->
          <div id="price-block" class="mb-2 sm:mb-3"></div>
          <div id="save-block" class="text-sm sm:text-base"></div>
          <div id="stock-block" class="mt-2"></div>

          <p id="details-description" class="subtle mb-4 sm:mb-6 leading-relaxed text-base sm:text-lg"></p>
          <button id="buy-now-button" class="btn-solid w-full shadow-lg transform hover:scale-105">
            <i class="fas fa-shopping-cart mr-2"></i> Order Now
          </button>
          <div id="details-video-container" class="w-full mt-4 sm:mt-6">
            <iframe id="details-video" class="rounded-xl shadow-md w-full h-52 sm:h-64" src="" title="Product video"
              frameborder="0" loading="lazy"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen referrerpolicy="strict-origin-when-cross-origin"></iframe>
          </div>
        </div>
      </div>

      <div id="more-details-section" class="mt-6 sm:mt-10 card-glass rounded-2xl sm:rounded-3xl shadow-lg p-5 sm:p-8">
        <h3 class="text-2xl sm:text-3xl font-bold heading mb-4 sm:mb-6">Product Overview</h3>
        <p id="long-description" class="subtle leading-relaxed mb-6 sm:mb-8 text-base sm:text-lg"></p>
        <div id="gallery-images-container" class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6"></div>
      </div>
    </div>

    <!-- SHIPPING -->
    <div id="shipping-page" class="page" style="display:none;">
      <button id="back-to-details"
        class="mb-4 sm:mb-6 surface px-4 py-2 hover:shadow transition flex items-center space-x-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        <span>Back to Product</span>
      </button>

      <div class="card-glass rounded-2xl sm:rounded-3xl shadow-2xl p-5 sm:p-8">
        <h2 class="text-2xl sm:text-4xl font-bold heading mb-6 sm:mb-8 text-center"><i
            class="fas fa-shipping-fast mr-3"></i> Order Information</h2>

        <div id="order-summary" class="card-glass rounded-xl sm:rounded-2xl p-5 sm:pb-6 mb-6 sm:mb-8">
          <p class="text-lg sm:text-xl font-bold heading mb-3 sm:mb-4">Order Summary</p>
          <div class="flex justify-between items-center mb-2">
            <span id="summary-product-title" class="subtle"></span>
            <span id="summary-product-price" class="font-semibold text-green-700 dark:text-green-400"></span>
          </div>
          <div class="flex justify-between items-center mb-2">
            <span class="subtle">Shipping Charge:</span>
            <span id="shipping-charge" class="font-semibold text-yellow-700 dark:text-yellow-400">৳0</span>
          </div>
          <div class="border-t my-3" style="border-color:var(--color-border)"></div>
          <div class="flex justify-between items-center text-lg sm:text-xl font-bold heading">
            <span>Total:</span>
            <span id="total-price" class="text-green-700 dark:text-green-400"></span>
          </div>
        </div>

        <form id="shipping-form" class="space-y-4 sm:space-y-6">
          <input type="hidden" id="product-title" name="product" />
          <input type="hidden" id="product-price" name="price" />

          <div class="grid md:grid-cols-2 gap-4 sm:gap-6">
            <div class="flex flex-col">
              <label for="customer-name" class="heading font-semibold mb-2"><i class="fas fa-user mr-2"></i>Full
                Name</label>
              <input type="text" id="customer-name" name="name" class="field" placeholder="Enter your full name"
                required />
            </div>
            <div class="flex flex-col">
              <label for="customer-phone" class="heading font-semibold mb-2"><i class="fas fa-phone mr-2"></i>Phone
                Number</label>
              <input type="tel" id="customer-phone" name="phone" class="field" placeholder="01XXXXXXXXX" required />
            </div>
          </div>

          <div class="flex flex-col">
            <label for="home-address" class="heading font-semibold mb-2"><i class="fas fa-home mr-2"></i>Home
              Address</label>
            <input type="text" id="home-address" name="address" class="field" placeholder="House/Flat, Road, Area"
              required />
          </div>

          <div class="grid md:grid-cols-2 gap-4 sm:gap-6">
            <div class="flex flex-col">
              <label for="thana-city" class="heading font-semibold mb-2"><i class="fas fa-map-marker-alt mr-2"></i>Thana
                / City</label>
              <input type="text" id="thana-city" name="thana" class="field" placeholder="e.g., Dhanmondi, Gulshan"
                required />
            </div>
            <div class="flex flex-col">
              <label for="district" class="heading font-semibold mb-2"><i class="fas fa-map mr-2"></i>District</label>
              <input type="text" id="district" name="district" class="field" placeholder="e.g., Dhaka, Chittagong"
                required />
            </div>
          </div>

          <button type="submit" class="btn-solid w-full shadow-lg transform hover:scale-105" id="order-submit-btn">
            <i class="fas fa-check-circle mr-2"></i> Confirm Order
          </button>
        </form>
      </div>
    </div>
  </div>

  <!-- Helpline FAB -->
  <div id="helpline-icon"
    class="fixed bottom-6 right-6 z-50 bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 rounded-full shadow-2xl cursor-pointer transition-all duration-300 hover:scale-110 pulse-animation">
    <i class="fas fa-headset text-xl"></i>
  </div>

  <!-- Helpline Modal -->
  <div id="helpline-modal"
    class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50 hidden">
    <div class="glass-effect rounded-3xl shadow-2xl w-full max-w-md p-8 relative">
      <button id="close-helpline-modal"
        class="absolute top-4 right-4 text-gray-300 hover:text-white transition-colors duration-200">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
      <h2 class="text-3xl font-bold heading mb-6 text-center"><i class="fas fa-comments mr-3"></i>Need Help?</h2>
      <form id="helpline-form" class="space-y-4">
        <div class="flex flex-col">
          <label for="helpline-name" class="heading font-semibold mb-2">Your Name</label>
          <input type="text" id="helpline-name" name="name" class="field" placeholder="Enter your name" required />
        </div>
        <div class="flex flex-col">
          <label for="helpline-phone" class="heading font-semibold mb-2">Your Phone Number</label>
          <input type="tel" id="helpline-phone" name="phone" class="field" placeholder="01XXXXXXXXX" required />
        </div>
        <div class="flex flex-col">
          <label for="helpline-message" class="heading font-semibold mb-2">Your Message</label>
          <textarea id="helpline-message" name="message" rows="4" class="field" placeholder="How can we help you?"
            required></textarea>
        </div>
        <button type="submit" class="btn-solid w-full shadow-lg" id="helpline-submit-btn"><i
            class="fas fa-paper-plane mr-2"></i> Send Message</button>
      </form>
    </div>
  </div>

  <script>
    /* =================== Media helpers: image-first, mobile-lazy, autoplay-safe =================== */
    const isIOS = () =>
      /iP(hone|od|ad)/.test(navigator.platform) ||
      (/MacIntel/.test(navigator.platform) && navigator.maxTouchPoints > 1);
    const isAndroid = () => /Android/i.test(navigator.userAgent);
    const isMobile = () => isIOS() || isAndroid() || window.matchMedia('(max-width: 767px)').matches;

    const isVideoExt = (src = '') => /\.(mp4|m4v|webm|ogg)(\?.*)?$/i.test(src);
    const isGifExt = (src = '') => /\.gif(\?.*)?$/i.test(src);

    const normalizeMediaList = (items = []) =>
      items.map(it => {
        if (typeof it === 'string') {
          const type = isVideoExt(it) ? 'video' : 'image';
          return { type, src: it, duration: type === 'image' ? (isGifExt(it) ? 6000 : 3000) : null, playFull: type === 'video', poster: null };
        }
        const src = it.src || it.url || '';
        const type = it.type || (isVideoExt(src) ? 'video' : 'image');
        return {
          type,
          src,
          duration: typeof it.durationMs === 'number' ? it.durationMs : (type === 'image' ? (isGifExt(src) ? 6000 : 3000) : null),
          playFull: it.playFull !== undefined ? it.playFull : (type === 'video'),
          poster: it.poster || null,
        };
      });

    const showTapOverlay = (slotEl, videoEl) => {
      if (slotEl.querySelector('.tap-to-play')) return;
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'tap-to-play';
      btn.innerHTML = '<i class="fas fa-play text-3xl"></i>';
      btn.addEventListener('click', () => {
        btn.remove();
        if (!videoEl.src && videoEl.dataset.src) { videoEl.src = videoEl.dataset.src; videoEl.load(); }
        videoEl.play().catch(() => { });
      });
      slotEl.appendChild(btn);
    };

    const renderMediaInto = (slotEl, item, fallbackPoster) => {
      slotEl.innerHTML = '';

      if (item.type === 'video') {
        const posterSrc = item.poster || fallbackPoster || '';
        if (posterSrc) {
          const img = document.createElement('img');
          img.src = posterSrc;
          img.alt = 'Product preview';
          img.loading = 'lazy';
          img.decoding = 'async';
          img.style.width = '100%';
          img.style.height = '100%';
          img.style.objectFit = 'contain';
          img.style.objectPosition = 'center';
          slotEl.appendChild(img);
        }

        const v = document.createElement('video');
        v.className = 'product-video';
        v.setAttribute('muted', ''); v.muted = true;
        v.setAttribute('playsinline', ''); v.setAttribute('webkit-playsinline', '');
        v.autoplay = true; v.controls = false; v.loop = false;
        v.preload = isMobile() ? 'metadata' : 'auto';
        if (posterSrc) v.setAttribute('poster', posterSrc);

        if (isMobile()) { v.dataset.src = item.src; } else { v.src = item.src; }

        const swapIn = () => {
          slotEl.innerHTML = '';
          slotEl.appendChild(v);
          v.play?.().catch(() => { showTapOverlay(slotEl, v); });
        };

        if (!isMobile()) {
          v.addEventListener('canplay', swapIn, { once: true });
          setTimeout(swapIn, 1500);
        } // on mobile we wait for observer->start()

        return v;
      }

      const img = document.createElement('img');
      img.src = item.src;
      img.alt = 'Product media';
      img.loading = 'lazy';
      img.decoding = 'async';
      img.style.width = '100%';
      img.style.height = '100%';
      img.style.objectFit = 'contain';
      img.style.objectPosition = 'center';
      slotEl.appendChild(img);
      return img;
    };

    const createCardMediaController = (slotEl, items) => {
      const seq = normalizeMediaList(items);
      if (!slotEl || seq.length === 0) return { start() { }, stop() { } };

      let idx = 0;
      let timer = null;
      let currentVideo = null;
      let running = false;
      const posterFallback = seq.find(x => x.type === 'image')?.src || null;

      const clearPending = () => {
        if (timer) { clearTimeout(timer); timer = null; }
        if (currentVideo) {
          currentVideo.pause?.();
          if (isMobile()) { currentVideo.removeAttribute('src'); currentVideo.load(); }
          const overlay = slotEl.querySelector('.tap-to-play');
          if (overlay) overlay.remove();
          currentVideo = null;
        }
      };

      const show = (i) => {
        clearPending();
        const item = seq[i];
        const el = renderMediaInto(slotEl, item, posterFallback);

        if (item.type === 'video') {
          currentVideo = el;

          if (isMobile()) {
            if (!currentVideo.src && currentVideo.dataset.src) {
              currentVideo.src = currentVideo.dataset.src;
              currentVideo.load();
              const swapNow = () => {
                slotEl.innerHTML = '';
                slotEl.appendChild(currentVideo);
                currentVideo.play().catch(() => showTapOverlay(slotEl, currentVideo));
              };
              currentVideo.addEventListener('canplay', swapNow, { once: true });
              setTimeout(swapNow, 1500);
            }
          } else {
            const fallbackMs = item.duration || 12000;
            let advanced = false;
            const advance = () => { if (advanced) return; advanced = true; idx = (i + 1) % seq.length; if (running) show(idx); };
            currentVideo.onended = advance;
            timer = setTimeout(advance, fallbackMs);
            currentVideo.play?.().catch(() => { });
          }
        } else {
          const wait = item.duration || 3000;
          timer = setTimeout(() => { idx = (i + 1) % seq.length; if (running) show(idx); }, wait);
        }
      };

      const start = () => { if (!running) { running = true; show(idx); } };
      const stop = () => { running = false; clearPending(); };

      if (!isMobile()) {
        slotEl.addEventListener('mouseenter', stop);
        slotEl.addEventListener('mouseleave', start);
      }

      document.addEventListener('visibilitychange', () => {
        if (document.hidden) stop(); else if (!isMobile()) start();
      });

      if (seq.length === 1) {
        if (seq[0].type === 'video') { return { start, stop }; }
        renderMediaInto(slotEl, seq[0], posterFallback);
        return { start() { }, stop() { } };
      }

      return { start, stop };
    };

    const observeOnMobile = (el, controller) => {
      if (!isMobile()) { controller.start(); return; }
      const io = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting && entry.intersectionRatio >= 0.45) controller.start();
          else controller.stop();
        });
      }, { threshold: [0, .2, .45, .8, 1], rootMargin: '120px 0px' });
      io.observe(el);
    };

    // Idle prewarm
    const prewarmAssets = (products) => {
      const top = products.slice(0, 3);
      const urls = [];
      top.forEach(p => {
        const firstImg = (p.cardImages || []).find(m => (typeof m === 'string' && !isVideoExt(m)) || (m.type === 'image'));
        const firstVid = (p.cardImages || []).find(m => (typeof m === 'string' && isVideoExt(m)) || (m.type === 'video'));
        if (firstImg) urls.push(typeof firstImg === 'string' ? firstImg : firstImg.src);
        if (firstVid) urls.push(typeof firstVid === 'string' ? firstVid : firstVid.src);
      });
      const unique = [...new Set(urls)];
      const go = () => unique.forEach(u => { try { fetch(u, { mode: 'no-cors', cache: 'force-cache' }); } catch (e) { } });
      if ('requestIdleCallback' in window) requestIdleCallback(go, { timeout: 2500 }); else setTimeout(go, 1500);
    };
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      /* Theme & logo */
      const updateLogos = () => {
        const isDark = document.body.classList.contains('dark');
        document.querySelectorAll('.brand-logo').forEach(img => {
          const lightSrc = img.getAttribute('data-light');
          const darkSrc = img.getAttribute('data-dark');
          img.src = isDark ? darkSrc : lightSrc;
        });
      };
      const setTheme = (t) => {
        document.body.className = t;
        localStorage.setItem('theme', t);
        updateLogos();
      };
      const savedTheme = localStorage.getItem('theme') || 'light';
      setTheme(savedTheme);
      const toggleTheme = () => setTheme(document.body.classList.contains('dark') ? 'light' : 'dark');
      document.getElementById('theme-toggle')?.addEventListener('click', toggleTheme);
      document.getElementById('theme-toggle-mobile')?.addEventListener('click', toggleTheme);

      /* Helpers */
      const formatCurrency = v => `৳${v}`;
      const getSavings = (original, current) => (original && original > current)
        ? { amount: original - current, percent: Math.round(((original - current) / original) * 100) }
        : null;

      /* Config */
      const ORDERS_API_URL = 'https://sheetdb.io/api/v1/z35cwzop13xqp';
      const HELPLINE_API_URL = 'https://sheetdb.io/api/v1/s6us0zf0tp74j';

      /* Products */
      const PRODUCTS = [
        {
          id: 'product1',
          name: 'M01/G21 Six-finger Gaming Trigger Control Mechanical button',
          originalPrice: 980, price: 820, inStock: true,
          description: 'Professional gaming trigger with mechanical buttons for enhanced mobile gaming experience. Features six-finger control for competitive advantage.',
          longDescription: 'The M01 Gaming Trigger revolutionizes mobile gaming with its advanced six-finger control system. Designed for serious gamers, it provides mechanical button feedback and ergonomic design for extended gaming sessions. Compatible with most smartphones and perfect for PUBG, Free Fire, and other competitive games.',
          cardImages: [
            { src: 'assets/images/g21/video/g21.mp4', type: 'video', playFull: true, poster: 'assets/images/g21/g21_1.jpg' },
            'assets/images/g21/g21_4.jpg',
            'assets/images/g21/g21_1.jpg'
          ],
          detailImages: [
            'assets/images/g21/main.jpg',
            'assets/images/g21/g21_4.jpg',
            'assets/images/g21/g21_3.png',
            'assets/images/g21/g21_1.jpg'
          ],
          instructionImages: [
            'assets/images/g21/g21_3.png',
            'assets/images/g21/g21_2.PNG'
          ],
          videoUrl: 'https://www.youtube.com/embed/dqrl1QOLqBA'
        },
        {
          id: 'product2',
          name: 'E9 Mobile Phone Game Joysticks Gamepad Trigger',
          originalPrice: 350, price: 229, inStock: true,
          description: 'Affordable gaming trigger solution for mobile gamers. Lightweight design with responsive triggers for improved gaming performance.',
          longDescription: 'The E9 Gaming Trigger offers excellent value for mobile gamers seeking enhanced control. Its lightweight design ensures comfortable extended gaming sessions while providing responsive trigger action.',
          cardImages: [
            { src: 'assets/images/E9/video/E9_video.mp4', type: 'video', playFull: true, poster: 'assets/images/E9/E9_1.jpg' },
            'assets/images/E9/E9_2.jpg',
            'assets/images/E9/E9_1.jpg'
          ],
          detailImages: [
            'assets/images/E9/E9_1.jpg',
            'assets/images/E9/E9_2.jpg',
            'assets/images/E9/E9_3.jpg',
            'assets/images/E9/E9_4.jpg'
          ],
          instructionImages: [
            'assets/images/E9/E9_3.jpg',
            'assets/images/E9/E9_4.jpg'
          ],
          videoUrl: 'https://www.youtube.com/embed/n3oF59s04_s'
        },
        {
          id: 'product6',
          name: 'JS32 Mobile Game Controller Gamepad L1R1 Trigger - up to 30 Clicks Per Second',
          originalPrice: 1550, price: 1250, inStock: false,
          description: 'Premium mobile game controller made of ABS material, designed for phones 6-11mm thick. CE and RoHS certified for quality assurance.',
          longDescription: 'JS32 Mobile Game Controller Gamepad L1R1 Trigger Aim Button Shooter Joystick for PUBG up to 30 Clicks Per Second for professional mobile gaming. Constructed from high-quality ABS material, it supports phones with thickness of 6-11mm.',
          cardImages: [
            { src: 'assets/images/JS32/video/JS32.mp4', type: 'video', playFull: true, poster: 'assets/images/JS32/JS32_1.jpg' },
            'assets/images/JS32/JS32_2.jpg',
            'assets/images/JS32/JS32_1.jpg'
          ],
          detailImages: [
            'assets/images/JS32/JS32_1.jpg',
            'assets/images/JS32/JS32_2.jpg',
            'assets/images/JS32/JS32_3.jpg',
            'assets/images/JS32/JS32_4.jpg'
          ],
          instructionImages: [
            'assets/images/JS32/JS32_3.jpg',
            'assets/images/JS32/JS32_4.jpg'
          ],
          videoUrl: 'https://www.youtube.com/embed/1B1P_wS_0Lg'
        },

        {
          id: 'product3',
          name: 'MEMO MB03 Mobile Joystick Controller',
          originalPrice: 3499, price: 1950, inStock: false,
          description: 'Premium mobile game controller made of ABS material, designed for phones 6-11mm thick. CE and RoHS certified for quality assurance.',
          longDescription: 'The MEMO MB03 Mobile Joystick is engineered for professional mobile gaming. Constructed from high-quality ABS material, it supports phones with thickness of 6-11mm.',
          cardImages: [
            { src: 'assets/images/MB03/video/MB03.mp4', type: 'video', playFull: true, poster: 'assets/images/MB03/MB03_1.jpg' },
            'assets/images/MB03/MB03_2.jpg',
            'assets/images/MB03/MB03_1.jpg'
          ],
          detailImages: [
            'assets/images/MB03/MB03_1.jpg',
            'assets/images/MB03/MB03_2.jpg',
            'assets/images/MB03/MB03_3.jpg',
            'assets/images/MB03/MB03_4.jpg'
          ],
          instructionImages: [
            'assets/images/MB03/MB03_3.jpg',
            'assets/images/MB03/MB03_4.jpg'
          ],
          videoUrl: 'https://www.youtube.com/embed/1B1P_wS_0Lg'
        },
        {
          id: 'product4',
          name: 'GT01 Gaming Trigger Pro',
          originalPrice: 320, price: 249, inStock: true,
          description: 'Advanced gaming trigger with enhanced grip and precision control. Designed for competitive mobile gaming with superior build quality.',
          longDescription: 'The GT01 Gaming Trigger Pro elevates your mobile gaming experience with its advanced engineering and superior build quality.',
          cardImages: [
            { src: 'assets/images/GT01/video/GT01.mp4', type: 'video', playFull: true, poster: 'assets/images/GT01/GT01_1.jpg' },
            'assets/images/GT01/GT01_2.jpg',
            'assets/images/GT01/GT01_1.jpg'
          ],
          detailImages: [
            'assets/images/GT01/GT01_1.jpg',
            'assets/images/GT01/GT01_2.jpg',
            'assets/images/GT01/GT01_3.jpg',
            'assets/images/GT01/GT01_4.jpg'
          ],
          instructionImages: [
            'assets/images/GT01/GT01_3.jpg',
            'assets/images/GT01/GT01_4.jpg'
          ],
          videoUrl: 'https://www.youtube.com/embed/n3oF59s04_s'
        },
        {
          id: 'product5',
          name: 'Dy66 Mobile Gaming Cooler',
          originalPrice: 450, price: 320, inStock: true,
          description: 'Keep your device cool with semiconductor tech for smoother, longer gaming.',
          longDescription: 'Rapid cooling • Quiet • Universal clip • Light & portable • USB powered.',
          cardImages: [
            { src: 'assets/images/Dy66/video/Dy66.mp4', type: 'video', playFull: true, poster: 'assets/images/Dy66/Dy66_1.jpg' },
            'assets/images/Dy66/Dy66_2.jpg',
            'assets/images/Dy66/Dy66_1.jpg'
          ],
          detailImages: [
            'assets/images/Dy66/Dy66_1.jpg',
            'assets/images/Dy66/Dy66_2.jpg',
            'assets/images/Dy66/Dy66_3.jpg',
            'assets/images/Dy66/Dy66_4.jpg'
          ],
          instructionImages: [
            'assets/images/Dy66/Dy66_3.jpg',
            'assets/images/Dy66/Dy66_4.jpg'
          ],
          videoUrl: 'https://www.youtube.com/embed/n3oF59s04_s'
        },

        {
          id: 'product7',
          name: 'Wireless Controller Gaming Joystick for Switch/PC/Android/TV/iOS',
          originalPrice: 1550, price: 1350, inStock: false,
          description: 'Wireless Android Gamepad Mobile Phone Controller Game Joystick for Switch/PC/Android/TV/iOS Enhanced Gaming Experience, Keep your device cool with semiconductor tech for smoother, longer gaming.',
          longDescription: 'Wireless Android Gamepad Mobile Phone Controller Game Joystick for Switch/PC/Android/TV/iOS Enhanced Gaming Experience',
          cardImages: [
            { src: 'assets/images/wireless_controller/video/wireless_controller.mp4', type: 'video', playFull: true, poster: 'assets/images/wireless_controller/wireless_controller_1.jpg' },
            'assets/images/wireless_controller/wireless_controller_2.jpg',
            'assets/images/wireless_controller/wireless_controller_1.jpg'
          ],
          detailImages: [
            'assets/images/wireless_controller/wireless_controller_1.jpg',
            'assets/images/wireless_controller/wireless_controller_2.jpg',
            'assets/images/wireless_controller/wireless_controller_3.jpg',
          ],
          instructionImages: [
            'assets/images/wireless_controller/wireless_controller_2.jpg',
            'assets/images/wireless_controller/wireless_controller_3.jpg'
          ],
          videoUrl: 'https://www.youtube.com/embed/n3oF59s04_s'
        }

      ];

      const HERO_SLIDER_IMAGES = [
        'https://images.unsplash.com/photo-1542751371-adc38448a05e?auto=format&fit=crop&w=1200&h=600&q=80',
        'https://images.unsplash.com/photo-1511512578047-dfb367046420?auto=format&fit=crop&w=1200&h=600&q=80',
        'https://images.unsplash.com/photo-1493711662062-fa541adb3fc8?auto=format&fit=crop&w=1200&h=600&q=80'
      ];

      /* DOM refs */
      const productListPage = document.getElementById('product-list-page');
      const productDetailsPage = document.getElementById('product-details-page');
      const shippingPage = document.getElementById('shipping-page');
      const homeLogoBtn = document.getElementById('home-logo');
      const homeLogoMobile = document.getElementById('home-logo-mobile');
      const backToProductsBtn = document.getElementById('back-to-products');
      const backToDetailsBtn = document.getElementById('back-to-details');
      const buyNowBtn = document.getElementById('buy-now-button');
      const shippingForm = document.getElementById('shipping-form');
      const thanaCityInput = document.getElementById('thana-city');
      const districtInput = document.getElementById('district');
      const shippingChargeSpan = document.getElementById('shipping-charge');
      const totalPriceSpan = document.getElementById('total-price');

      const mainProductImage = document.getElementById('main-product-image');
      const sliderPrevBtn = document.getElementById('slider-prev');
      const sliderNextBtn = document.getElementById('slider-next');
      const thumbnailsContainer = document.getElementById('thumbnails-container');
      const detailsTitle = document.getElementById('details-title');
      const detailsDescription = document.getElementById('details-description');
      const detailsVideo = document.getElementById('details-video');
      const longDescription = document.getElementById('long-description');
      const galleryImagesContainer = document.getElementById('gallery-images-container');
      const priceBlock = document.getElementById('price-block');
      const saveBlock = document.getElementById('save-block');
      const stockBlock = document.getElementById('stock-block');
      const summaryProductPrice = document.getElementById('summary-product-price');

      const helplineIcon = document.getElementById('helpline-icon');
      const helplineModal = document.getElementById('helpline-modal');
      const closeHelplineModalBtn = document.getElementById('close-helpline-modal');
      const helplineForm = document.getElementById('helpline-form');
      const orderSubmitBtn = document.getElementById('order-submit-btn');
      const helplineSubmitBtn = document.getElementById('helpline-submit-btn');

      let currentProduct = null, currentShippingCost = 0, currentImageIndex = 0, heroSliderIndex = 0, heroSliderInterval;

      /* Button loading helper */
      const setButtonLoading = (btn, loading, textDefault, textLoading) => {
        if (!btn) return;
        if (loading) {
          btn.dataset.label = textDefault;
          btn.disabled = true;
          btn.classList.add('btn-disabled');
          btn.innerHTML = `<i class="fas fa-circle-notch fa-spin mr-2"></i> ${textLoading}`;
        } else {
          btn.disabled = false;
          btn.classList.remove('btn-disabled');
          btn.innerHTML = textDefault;
        }
      };


      /* Hero slider */
      const startHeroSlider = () => {
        const sliderContainer = document.getElementById('hero-slider-container');
        sliderContainer.innerHTML = HERO_SLIDER_IMAGES.map((img, i) => `
          <img src="${img}" class="slider-image absolute top-0 left-0 w-full h-full object-cover rounded-2xl sm:rounded-3xl ${i === 0 ? 'opacity-100' : 'opacity-0'}" alt="Hero ${i + 1}" ${i === 0 ? 'fetchpriority="high"' : ''} decoding="async" loading="${i === 0 ? 'eager' : 'lazy'}">
        `).join('');
        sliderContainer.style.position = 'relative';
        const images = sliderContainer.querySelectorAll('.slider-image');
        heroSliderInterval = setInterval(() => {
          images[heroSliderIndex].classList.replace('opacity-100', 'opacity-0');
          heroSliderIndex = (heroSliderIndex + 1) % images.length;
          images[heroSliderIndex].classList.replace('opacity-0', 'opacity-100');
        }, 4000);
      };

      /* Product grid */
      const renderProductList = () => {
        const grid = document.querySelector('#product-list-page > div.grid');
        grid.innerHTML = '';

        PRODUCTS.forEach(p => {
          const savings = getSavings(p.originalPrice, p.price);
          const saveBadgeHTML = savings ? `<div class="absolute top-3 right-3 badge px-3 py-1 text-xs sm:text-sm font-bold shadow-lg">Save ${savings.percent}%</div>` : '';
          const stockBadgeHTML = p.inStock ? '' : `<div class="absolute top-3 left-3 badge-red px-3 py-1 text-xs sm:text-sm font-bold shadow-lg">Stock Out</div>`;

          const card = document.createElement('div');
          card.className = 'product-card glass-effect rounded-2xl sm:rounded-3xl shadow-2xl overflow-hidden';
          card.innerHTML = `
            <div class="product-image relative">
              <div class="media-slot"></div>
              ${saveBadgeHTML}
              ${stockBadgeHTML}
            </div>
            <div class="p-4 sm:p-6">
              <h2 class="text-lg sm:text-xl font-bold heading mb-2 sm:mb-3 cursor-pointer">${p.name}</h2>
              <p class="subtle text-sm mb-4 leading-relaxed">${p.description.substring(0, 120)}...</p>
              <div class="flex items-center justify-between">
                <div class="flex items-baseline gap-2">
                  <span class="text-xl sm:text-2xl font-bold text-green-700 dark:text-green-400">${formatCurrency(p.price)}</span>
                  ${p.originalPrice ? `<span class="subtle line-through text-sm sm:text-base">${formatCurrency(p.originalPrice)}</span>` : ''}
                </div>
                ${p.inStock
              ? `<button class="buy-now-card-button btn-primary text-sm" data-product-id="${p.id}">
                      <i class="fas fa-shopping-cart mr-1"></i> Order Now
                     </button>`
              : `<button class="btn-primary text-sm btn-disabled" disabled aria-disabled="true">Stock Out</button>`
            }
              </div>
            </div>`;

          const slot = card.querySelector('.media-slot');
          const controller = createCardMediaController(slot, p.cardImages || p.detailImages || []);
          observeOnMobile(card, controller);

          card.querySelector('.product-image').addEventListener('click', () => showProductDetails(p.id));
          card.querySelector('h2').addEventListener('click', () => showProductDetails(p.id));

          const btn = card.querySelector('.buy-now-card-button');
          if (btn) {
            btn.addEventListener('click', (e) => { e.stopPropagation(); showShippingPage(p.id); });
          }

          grid.appendChild(card);
        });

        prewarmAssets(PRODUCTS);
      };

      /* ---------- Details rendering (split out so we can prepare before showing) ---------- */
      const renderProductDetails = (p) => {
        if (!p) return;
        detailsTitle.textContent = p.name;
        detailsDescription.textContent = p.description;
        detailsVideo.src = p.videoUrl || '';
        longDescription.textContent = p.longDescription || '';
        renderPriceInfo(p);

        const detailImgs = p.detailImages || [];
        thumbnailsContainer.innerHTML = '';
        detailImgs.forEach((src, i) => {
          const thumb = document.createElement('img');
          thumb.src = src;
          thumb.alt = 'Thumbnail ' + (i + 1);
          thumb.loading = 'lazy';
          thumb.decoding = 'async';
          thumb.className = 'thumbnail-image thumb object-contain bg-white rounded-lg shadow-sm cursor-pointer transition-all duration-200 hover:scale-105';
          thumb.addEventListener('click', () => { currentImageIndex = i; updateMainImage(); });
          thumbnailsContainer.appendChild(thumb);
        });
        updateMainImage();

        const instructImgs = p.instructionImages || [];
        galleryImagesContainer.innerHTML = '';
        instructImgs.forEach(src => {
          const img = document.createElement('img');
          img.src = src;
          img.alt = p.name + ' Instruction';
          img.loading = 'lazy';
          img.decoding = 'async';
          img.className = 'w-full h-60 sm:h-72 object-contain bg-white rounded-xl shadow-lg';
          galleryImagesContainer.appendChild(img);
        });

        if (p.inStock) {
          buyNowBtn.disabled = false;
          buyNowBtn.classList.remove('btn-disabled');
          buyNowBtn.innerHTML = '<i class="fas fa-shopping-cart mr-2"></i> Order Now';
        } else {
          buyNowBtn.disabled = true;
          buyNowBtn.classList.add('btn-disabled');
          buyNowBtn.innerHTML = 'Stock Out';
        }
      };

      /* Details slider helpers */
      const updateMainImage = () => {
        const imgs = currentProduct?.detailImages || [];
        if (!imgs.length) return;
        mainProductImage.src = imgs[currentImageIndex];
      };

      const navigateSlider = (dir) => {
        const imgs = currentProduct?.detailImages || [];
        if (imgs.length <= 1) return;
        currentImageIndex = (currentImageIndex + dir + imgs.length) % imgs.length;
        updateMainImage();
      };

      /* Price/stock block */
      const renderPriceInfo = (p) => {
        const savings = getSavings(p.originalPrice, p.price);
        priceBlock.innerHTML = `
          <div class="flex items-baseline gap-3">
            <span class="text-2xl sm:text-3xl font-bold text-green-700 dark:text-green-400">${formatCurrency(p.price)}</span>
            ${p.originalPrice ? `<span class="subtle line-through text-lg sm:text-xl">${formatCurrency(p.originalPrice)}</span>` : ''}
          </div>
        `;
        saveBlock.innerHTML = savings ? `<div class="text-emerald-700 dark:text-emerald-400 mt-1">You save <strong>${formatCurrency(savings.amount)}</strong> (${savings.percent}%)</div>` : '';
        stockBlock.innerHTML = p.inStock ? '' : `<div class="text-red-600 dark:text-red-400 font-semibold mt-2">Currently out of stock</div>`;
      };

      /* Show details (visible) */
      const showProductDetails = (id) => {
        currentProduct = PRODUCTS.find(p => p.id === id);
        if (!currentProduct) return;
        currentImageIndex = 0;

        renderProductDetails(currentProduct);

        productListPage.style.display = 'none';
        shippingPage.style.display = 'none';
        productDetailsPage.style.display = 'block';
        window.scrollTo({ top: 0, behavior: 'smooth' });

        // ===== Pixel: SPA PV + ViewContent =====
        _fx.pv('details');
        const vcParams = {
          content_name: currentProduct.name,
          content_ids: [currentProduct.id],
          content_type: 'product',
          value: currentProduct.price
        };
        const eventID = _fx.track('ViewContent', vcParams);
        sendCAPI('ViewContent', vcParams, eventID);
      };

      /* Shipping */
      const showShippingPage = (productId = null) => {
        if (productId) { currentProduct = PRODUCTS.find(p => p.id === productId); }
        if (!currentProduct) return;

        if (!currentProduct.inStock) {
          Swal.fire({ icon: 'warning', title: 'Stock Out', text: 'This product is currently out of stock.' });
          return;
        }

        // Prepare details content so that "Back to Product" shows correct product
        currentImageIndex = 0;
        renderProductDetails(currentProduct);

        document.getElementById('product-title').value = currentProduct.name;
        document.getElementById('product-price').value = currentProduct.price;
        document.getElementById('summary-product-title').textContent = currentProduct.name;
        summaryProductPrice.textContent = formatCurrency(currentProduct.price);
        calculateShipping();

        productDetailsPage.style.display = 'none';
        productListPage.style.display = 'none';
        shippingPage.style.display = 'block';
        window.scrollTo({ top: 0, behavior: 'smooth' });

        // ===== Pixel: SPA PV + InitiateCheckout =====
        _fx.pv('shipping');
        const icParams = {
          content_ids: [currentProduct.id],
          content_type: 'product',
          value: currentProduct.price
        };
        const eventID = _fx.track('InitiateCheckout', icParams);
        sendCAPI('InitiateCheckout', icParams, eventID);
      };

      const calculateShipping = () => {
        if (!currentProduct) return;
        const inDhaka = (thanaCityInput.value.toLowerCase().includes('dhaka') || districtInput.value.toLowerCase().includes('dhaka'));
        currentShippingCost = inDhaka ? 80 : 120;
        shippingChargeSpan.textContent = `৳${currentShippingCost}`;
        totalPriceSpan.textContent = `৳${currentProduct.price + currentShippingCost}`;
      };

      const placeOrder = async (event) => {
        event.preventDefault();
        if (!currentProduct?.inStock) {
          Swal.fire({ icon: 'warning', title: 'Stock Out', text: 'This product is currently out of stock.' });
          return;
        }
        if (ORDERS_API_URL.includes('YOUR_ORDERS_API_URL')) {
          Swal.fire({ icon: 'error', title: 'Configuration Error', text: 'Please configure your SheetDB.io API URL for orders first.' }); return;
        }

        // ===== Advanced Matching: add phone (if present) before firing Purchase later =====
        const phoneForAM = document.getElementById('customer-phone')?.value || '';
        if (phoneForAM) { try { fbq('init', FB_PIXEL_ID, { ph: phoneForAM }); } catch (_) { } }

        setButtonLoading(orderSubmitBtn, true, '<i class="fas fa-check-circle mr-2"></i> Confirm Order', 'Processing...');

        const formData = new FormData(shippingForm);
        const price = parseInt(formData.get('price'), 10) || 0;
        const totalAmount = price + currentShippingCost;

        const orderData = {
          product: formData.get('product'),
          name: formData.get('name'),
          phone: formData.get('phone'),
          address: formData.get('address'),
          thana: formData.get('thana'),
          district: formData.get('district'),
          price: price,
          shipping: currentShippingCost,
          total: totalAmount,
          timestamp: new Date().toLocaleString()
        };
        try {
          const res = await fetch(ORDERS_API_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ data: orderData }) });
          if (res.ok) {
            // ===== Pixel: Purchase on success only =====
            const purchaseParams = {
              value: totalAmount,
              contents: [{ id: currentProduct.id, quantity: 1, item_price: currentProduct.price }],
              content_ids: [currentProduct.id],
              content_type: 'product',
              num_items: 1,
              order_id: _fx.uuid() // or your real order number
            };
            const eventID = _fx.track('Purchase', purchaseParams);
            sendCAPI('Purchase', purchaseParams, eventID);

            await Swal.fire({ icon: 'success', title: 'Order Placed Successfully!', text: 'We will confirm your order by phone call within 24 hours. Thank you for choosing Trustiva!', confirmButtonColor: '#10B981' });
            shippingForm.reset();
            shippingPage.style.display = 'none';
            productListPage.style.display = 'block';

            // SPA PV back to home (optional)
            _fx.pv('home');
          } else {
            const err = await res.json().catch(() => ({}));
            console.error('API Error:', err);
            Swal.fire({ icon: 'error', title: 'Order Failed', text: 'Failed to place order. Please try again or contact support.' });
          }
        } catch (err) {
          console.error('Fetch Error:', err);
          Swal.fire({ icon: 'error', title: 'Connection Error', text: 'Please check your internet connection and try again.' });
        } finally {
          setButtonLoading(orderSubmitBtn, false, '<i class="fas fa-check-circle mr-2"></i> Confirm Order', 'Processing...');
        }
      };

      /* Helpline */
      const sendMessage = async (event) => {
        event.preventDefault();
        if (HELPLINE_API_URL.includes('YOUR_HELPLINE_API_URL')) {
          Swal.fire({ icon: 'error', title: 'Configuration Error', text: 'Please configure your SheetDB.io API URL for the helpline form first.' }); return;
        }

        setButtonLoading(helplineSubmitBtn, true, '<i class="fas fa-paper-plane mr-2"></i> Send Message', 'Sending...');

        const formData = new FormData(helplineForm);
        const messageData = {
          name: formData.get('name'),
          phone: formData.get('phone'),
          message: formData.get('message'),
          timestamp: new Date().toLocaleString()
        };
        try {
          const res = await fetch(HELPLINE_API_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ data: messageData }) });
          if (res.ok) {
            // ===== Pixel: Lead when helpline submits successfully =====
            const leadParams = { content_name: 'Helpline' };
            const eventID = _fx.track('Lead', leadParams);
            sendCAPI('Lead', leadParams, eventID);

            await Swal.fire({ icon: 'success', title: 'Message Sent!', text: 'Your message was sent successfully. We will contact you soon.', confirmButtonColor: '#10B981' });
            helplineForm.reset(); helplineModal.classList.add('hidden');
          } else {
            const err = await res.json().catch(() => ({}));
            console.error('API Error:', err);
            Swal.fire({ icon: 'error', title: 'Failed to Send', text: 'Failed to send message. Please try again.' });
          }
        } catch (err) {
          console.error('Fetch Error:', err);
          Swal.fire({ icon: 'error', title: 'Connection Error', text: 'Please check your internet connection and try again.' });
        } finally {
          setButtonLoading(helplineSubmitBtn, false, '<i class="fas fa-paper-plane mr-2"></i> Send Message', 'Sending...');
        }
      };

      /* Events */
      document.getElementById('back-to-products').addEventListener('click', () => {
        productDetailsPage.style.display = 'none';
        productListPage.style.display = 'block';
        _fx.pv('home'); // SPA PV
      });

      // IMPORTANT: Back from Shipping -> return to THAT product's details
      document.getElementById('back-to-details').addEventListener('click', () => {
        if (currentProduct) {
          showProductDetails(currentProduct.id); // renders & shows correct product detail (fires VC again, OK)
        } else {
          // safety fallback
          shippingPage.style.display = 'none';
          productListPage.style.display = 'block';
          _fx.pv('home');
        }
      });

      buyNowBtn.addEventListener('click', () => showShippingPage());
      shippingForm.addEventListener('submit', placeOrder);
      thanaCityInput.addEventListener('input', calculateShipping);
      districtInput.addEventListener('input', calculateShipping);
      sliderNextBtn.addEventListener('click', () => navigateSlider(1));
      sliderPrevBtn.addEventListener('click', () => navigateSlider(-1));

      const goHome = (e) => { e.preventDefault(); productDetailsPage.style.display = 'none'; shippingPage.style.display = 'none'; productListPage.style.display = 'block'; window.scrollTo({ top: 0, behavior: 'smooth' }); _fx.pv('home'); }
      homeLogoBtn?.addEventListener('click', goHome);
      homeLogoMobile?.addEventListener('click', goHome);

      helplineIcon.addEventListener('click', () => helplineModal.classList.remove('hidden'));
      closeHelplineModalBtn.addEventListener('click', () => helplineModal.classList.add('hidden'));
      helplineForm.addEventListener('submit', sendMessage);

      document.querySelectorAll('a[href^="#"]').forEach(a => {
        a.addEventListener('click', function (e) { e.preventDefault(); const t = document.querySelector(this.getAttribute('href')); if (t) { t.scrollIntoView({ behavior: 'smooth', block: 'start' }) } });
      });

      // Init
      renderProductList();
      startHeroSlider();

      // ===== Pixel: initial SPA "home" pageview for the product list =====
      _fx.pv('home');
    });
  </script>
</body>

</html>